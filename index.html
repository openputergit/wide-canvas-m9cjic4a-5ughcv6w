<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FinBuddy - Your AI Financial Advisor</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/three@0.150.1/build/three.min.js"></script>
    <script src="https://unpkg.com/three@0.150.1/examples/js/controls/OrbitControls.js"></script>
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            margin: 0;
            padding: 0;
            overflow-x: hidden;
        }
        
        #canvas-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
        }
        
        .glassmorphism {
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.18);
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
            border-radius: 20px;
        }
        
        .glass-button {
            background: rgba(255, 255, 255, 0.25);
            backdrop-filter: blur(4px);
            -webkit-backdrop-filter: blur(4px);
            border: 1px solid rgba(255, 255, 255, 0.18);
            border-radius: 10px;
            transition: all 0.3s ease;
        }
        
        .glass-button:hover {
            background: rgba(255, 255, 255, 0.35);
            transform: translateY(-2px);
        }
        
        .chat-input {
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.18);
        }
        
        .loader {
            width: 48px;
            height: 48px;
            border: 5px solid rgba(255, 255, 255, 0.7);
            border-bottom-color: transparent;
            border-radius: 50%;
            animation: rotation 1s linear infinite;
            margin: 1rem auto;
        }
        
        @keyframes rotation {
            0% { transform: rotate(0deg) }
            100% { transform: rotate(360deg) }
        }
        
        /* Scrollbar styling */
        ::-webkit-scrollbar {
            width: 6px;
        }
        
        ::-webkit-scrollbar-track {
            background: rgba(255,255,255,0.1);
        }
        
        ::-webkit-scrollbar-thumb {
            background-color: rgba(255,255,255,0.3);
            border-radius: 3px;
        }
        
        .voice-active {
            animation: pulse 1.5s infinite;
        }
        
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(255, 255, 255, 0.5); }
            70% { box-shadow: 0 0 0 10px rgba(255, 255, 255, 0); }
            100% { box-shadow: 0 0 0 0 rgba(255, 255, 255, 0); }
        }
        
        .slide-in {
            animation: slideIn 0.3s ease forwards;
        }
        
        @keyframes slideIn {
            0% { transform: translateY(20px); opacity: 0; }
            100% { transform: translateY(0); opacity: 1; }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-indigo-900 via-purple-800 to-blue-800 min-h-screen text-white">
    <div id="canvas-container"></div>

    <!-- Navigation -->
    <nav class="glassmorphism p-4 m-4">
        <div class="container mx-auto flex flex-col sm:flex-row justify-between items-center">
            <div class="flex items-center mb-4 sm:mb-0">
                <i class="bi bi-coin text-3xl mr-2 text-yellow-400"></i>
                <h1 class="text-2xl font-bold">FinBuddy</h1>
            </div>
            <div class="flex flex-wrap gap-2 justify-center">
                <button class="glass-button px-4 py-2 flex items-center" onclick="toggleView('chat')">
                    <i class="bi bi-chat-dots-fill mr-2"></i>Chat
                </button>
                <button class="glass-button px-4 py-2 flex items-center" onclick="toggleView('budget')">
                    <i class="bi bi-wallet-fill mr-2"></i>Budget
                </button>
                <button class="glass-button px-4 py-2 flex items-center" onclick="toggleView('learn')">
                    <i class="bi bi-book-fill mr-2"></i>Learn
                </button>
                <button class="glass-button px-4 py-2 flex items-center" onclick="toggleView('profile')">
                    <i class="bi bi-person-fill mr-2"></i>Profile
                </button>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="container mx-auto p-4">
        <!-- Chat View -->
        <div id="chat-view" class="view-section">
            <div class="glassmorphism p-6 mb-4 slide-in">
                <div id="chat-messages" class="h-96 overflow-y-auto mb-4 py-2 px-4">
                    <div class="mb-4">
                        <div class="glassmorphism p-3 inline-block rounded-lg max-w-[80%]">
                            <p>ðŸ‘‹ Hi! I'm FinBuddy, your AI financial advisor. How can I help you today?</p>
                        </div>
                    </div>
                </div>
                <div class="flex gap-2 items-center">
                    <button id="voice-button" class="glass-button p-3 flex items-center justify-center" onclick="toggleVoiceInput()">
                        <i class="bi bi-mic text-xl"></i>
                    </button>
                    <input type="text" id="chat-input" class="chat-input w-full p-3 text-white" placeholder="Ask about budgeting, investing, or saving tips...">
                    <button class="glass-button p-3 flex items-center justify-center" onclick="sendMessage()">
                        <i class="bi bi-send text-xl"></i>
                    </button>
                </div>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 slide-in" style="animation-delay: 0.1s;">
                <div class="glassmorphism p-4">
                    <h3 class="text-lg font-semibold mb-2 flex items-center">
                        <i class="bi bi-piggy-bank-fill text-xl mr-2 text-pink-300"></i> Quick Savings Tips
                    </h3>
                    <p class="text-sm opacity-80">Try the 50/30/20 rule: 50% for needs, 30% for wants, and 20% for savings.</p>
                </div>
                <div class="glassmorphism p-4">
                    <h3 class="text-lg font-semibold mb-2 flex items-center">
                        <i class="bi bi-graph-up-arrow text-xl mr-2 text-green-300"></i> Investment Basics
                    </h3>
                    <p class="text-sm opacity-80">Start investing early, even small amounts. Compound interest is your best friend!</p>
                </div>
                <div class="glassmorphism p-4">
                    <h3 class="text-lg font-semibold mb-2 flex items-center">
                        <i class="bi bi-credit-card-fill text-xl mr-2 text-orange-300"></i> Debt Management
                    </h3>
                    <p class="text-sm opacity-80">Prioritize high-interest debt first while making minimum payments on others.</p>
                </div>
            </div>
        </div>

        <!-- Budget View -->
        <div id="budget-view" class="view-section hidden">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-4 mb-4">
                <div class="glassmorphism p-6 slide-in">
                    <h2 class="text-xl font-bold mb-4 flex items-center">
                        <i class="bi bi-pie-chart-fill mr-2 text-blue-300"></i> Budget Overview
                    </h2>
                    <canvas id="budgetChart" height="200"></canvas>
                    <div class="grid grid-cols-3 mt-4 text-center">
                        <div>
                            <p class="text-sm opacity-70">Income</p>
                            <p class="text-xl font-semibold">$5,000</p>
                        </div>
                        <div>
                            <p class="text-sm opacity-70">Expenses</p>
                            <p class="text-xl font-semibold">$3,000</p>
                        </div>
                        <div>
                            <p class="text-sm opacity-70">Savings</p>
                            <p class="text-xl font-semibold">$2,000</p>
                        </div>
                    </div>
                </div>
                
                <div class="glassmorphism p-6 slide-in" style="animation-delay: 0.1s;">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-xl font-bold flex items-center">
                            <i class="bi bi-receipt mr-2 text-green-300"></i> Expense Tracker
                        </h2>
                        <button class="glass-button px-4 py-2 flex items-center" onclick="addExpense()">
                            <i class="bi bi-plus mr-1"></i> Add Expense
                        </button>
                    </div>
                    <div id="expense-list" class="space-y-2 max-h-[250px] overflow-y-auto p-2">
                        <div class="glassmorphism p-3 flex justify-between">
                            <div class="flex items-center">
                                <i class="bi bi-house-fill mr-2 text-blue-300"></i>
                                <span>Rent</span>
                            </div>
                            <span>$1,200</span>
                        </div>
                        <div class="glassmorphism p-3 flex justify-between">
                            <div class="flex items-center">
                                <i class="bi bi-cart-fill mr-2 text-yellow-300"></i>
                                <span>Groceries</span>
                            </div>
                            <span>$450</span>
                        </div>
                        <div class="glassmorphism p-3 flex justify-between">
                            <div class="flex items-center">
                                <i class="bi bi-lightning-fill mr-2 text-red-300"></i>
                                <span>Utilities</span>
                            </div>
                            <span>$200</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="glassmorphism p-6 mb-4 slide-in" style="animation-delay: 0.2s;">
                <h2 class="text-xl font-bold mb-4 flex items-center">
                    <i class="bi bi-graph-up mr-2 text-purple-300"></i> Monthly Spending Trends
                </h2>
                <canvas id="spendingTrendsChart" height="100"></canvas>
            </div>
        </div>

        <!-- Learn View -->
        <div id="learn-view" class="view-section hidden">
            <h2 class="text-2xl font-bold mb-4 px-2 slide-in">Financial Education</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                <div class="glassmorphism p-6 slide-in">
                    <div class="flex items-center mb-3">
                        <div class="w-12 h-12 rounded-full glassmorphism flex items-center justify-center mr-3">
                            <i class="bi bi-graph-up-arrow text-2xl text-green-300"></i>
                        </div>
                        <h3 class="text-lg font-bold">Investing Basics</h3>
                    </div>
                    <p class="opacity-80 mb-3">Learn the fundamentals of investing and growing your wealth effectively.</p>
                    <ul class="space-y-2 opacity-90">
                        <li class="flex items-center"><i class="bi bi-check2-circle mr-2 text-green-300"></i> Types of investments</li>
                        <li class="flex items-center"><i class="bi bi-check2-circle mr-2 text-green-300"></i> Risk management</li>
                        <li class="flex items-center"><i class="bi bi-check2-circle mr-2 text-green-300"></i> Building a portfolio</li>
                    </ul>
                    <button class="glass-button w-full mt-4 py-2">Start Learning</button>
                </div>
                
                <div class="glassmorphism p-6 slide-in" style="animation-delay: 0.1s;">
                    <div class="flex items-center mb-3">
                        <div class="w-12 h-12 rounded-full glassmorphism flex items-center justify-center mr-3">
                            <i class="bi bi-credit-card text-2xl text-red-300"></i>
                        </div>
                        <h3 class="text-lg font-bold">Debt Management</h3>
                    </div>
                    <p class="opacity-80 mb-3">Strategies for managing and reducing your debt effectively.</p>
                    <ul class="space-y-2 opacity-90">
                        <li class="flex items-center"><i class="bi bi-check2-circle mr-2 text-green-300"></i> Debt snowball method</li>
                        <li class="flex items-center"><i class="bi bi-check2-circle mr-2 text-green-300"></i> Improving credit score</li>
                        <li class="flex items-center"><i class="bi bi-check2-circle mr-2 text-green-300"></i> Negotiation tactics</li>
                    </ul>
                    <button class="glass-button w-full mt-4 py-2">Start Learning</button>
                </div>
                
                <div class="glassmorphism p-6 slide-in" style="animation-delay: 0.2s;">
                    <div class="flex items-center mb-3">
                        <div class="w-12 h-12 rounded-full glassmorphism flex items-center justify-center mr-3">
                            <i class="bi bi-piggy-bank text-2xl text-blue-300"></i>
                        </div>
                        <h3 class="text-lg font-bold">Saving Strategies</h3>
                    </div>
                    <p class="opacity-80 mb-3">Smart ways to save money and build your emergency fund.</p>
                    <ul class="space-y-2 opacity-90">
                        <li class="flex items-center"><i class="bi bi-check2-circle mr-2 text-green-300"></i> Automating savings</li>
                        <li class="flex items-center"><i class="bi bi-check2-circle mr-2 text-green-300"></i> Building emergency funds</li>
                        <li class="flex items-center"><i class="bi bi-check2-circle mr-2 text-green-300"></i> Daily saving hacks</li>
                    </ul>
                    <button class="glass-button w-full mt-4 py-2">Start Learning</button>
                </div>
            </div>
            
            <div class="glassmorphism p-6 mb-4 slide-in" style="animation-delay: 0.3s;">
                <h3 class="text-xl font-bold mb-4">Financial Terms Glossary</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <h4 class="font-semibold mb-1">APR (Annual Percentage Rate)</h4>
                        <p class="opacity-80 text-sm">The yearly interest rate charged on borrowed money that includes fees.</p>
                    </div>
                    <div>
                        <h4 class="font-semibold mb-1">ETF (Exchange-Traded Fund)</h4>
                        <p class="opacity-80 text-sm">A type of investment fund traded on stock exchanges, similar to stocks.</p>
                    </div>
                    <div>
                        <h4 class="font-semibold mb-1">Compound Interest</h4>
                        <p class="opacity-80 text-sm">Interest calculated on the initial principal and accumulated interest over time.</p>
                    </div>
                    <div>
                        <h4 class="font-semibold mb-1">Liquidity</h4>
                        <p class="opacity-80 text-sm">How easily an asset can be converted into cash without affecting its market price.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Profile View -->
        <div id="profile-view" class="view-section hidden">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-4">
                <div class="lg:col-span-1">
                    <div class="glassmorphism p-6 mb-4 slide-in">
                        <div class="flex flex-col items-center mb-4">
                            <div class="w-24 h-24 rounded-full glassmorphism flex items-center justify-center mb-3">
                                <i class="bi bi-person-fill text-4xl"></i>
                            </div>
                            <h2 class="text-xl font-bold">Personal Profile</h2>
                        </div>
                        <div class="space-y-2">
                            <div class="flex justify-between">
                                <span class="opacity-70">Savings Rate</span>
                                <span class="font-semibold">40%</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-2.5 dark:bg-gray-700">
                                <div class="bg-blue-400 h-2.5 rounded-full" style="width: 40%"></div>
                            </div>
                            
                            <div class="flex justify-between mt-2">
                                <span class="opacity-70">Risk Tolerance</span>
                                <span class="font-semibold">Moderate</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-2.5 dark:bg-gray-700">
                                <div class="bg-yellow-400 h-2.5 rounded-full" style="width: 65%"></div>
                            </div>
                            
                            <div class="flex justify-between mt-2">
                                <span class="opacity-70">Financial Health</span>
                                <span class="font-semibold">Good</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-2.5 dark:bg-gray-700">
                                <div class="bg-green-400 h-2.5 rounded-full" style="width: 75%"></div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="lg:col-span-2">
                    <div class="glassmorphism p-6 slide-in" style="animation-delay: 0.1s;">
                        <h2 class="text-xl font-bold mb-4">Financial Profile</h2>
                        <form id="profile-form" class="space-y-4">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block mb-2 opacity-90">Monthly Income</label>
                                    <input type="number" class="chat-input w-full p-3 text-white" id="income" placeholder="$" value="5000">
                                </div>
                                <div>
                                    <label class="block mb-2 opacity-90">Monthly Expenses</label>
                                    <input type="number" class="chat-input w-full p-3 text-white" id="expenses" placeholder="$" value="3000">
                                </div>
                            </div>
                            <div>
                                <label class="block mb-2 opacity-90">Financial Goals</label>
                                <textarea class="chat-input w-full p-3 text-white" id="goals" rows="3" placeholder="What are your financial goals?">Buy a house in 5 years and save for retirement.</textarea>
                            </div>
                            
                            <div>
                                <label class="block mb-2 opacity-90">Risk Tolerance</label>
                                <select class="chat-input w-full p-3 text-white bg-transparent" id="risk">
                                    <option value="low">Conservative (Low Risk)</option>
                                    <option value="moderate" selected>Moderate</option>
                                    <option value="high">Aggressive (High Risk)</option>
                                </select>
                            </div>
                            
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <div>
                                    <label class="block mb-2 opacity-90">Debt Amount</label>
                                    <input type="number" class="chat-input w-full p-3 text-white" id="debt" placeholder="$" value="10000">
                                </div>
                                <div>
                                    <label class="block mb-2 opacity-90">Savings</label>
                                    <input type="number" class="chat-input w-full p-3 text-white" id="savings" placeholder="$" value="15000">
                                </div>
                                <div>
                                    <label class="block mb-2 opacity-90">Investments</label>
                                    <input type="number" class="chat-input w-full p-3 text-white" id="investments" placeholder="$" value="25000">
                                </div>
                            </div>
                            
                            <div class="flex justify-end mt-4">
                                <button type="submit" class="glass-button px-6 py-3 flex items-center" id="save-profile-btn">
                                    <i class="bi bi-save mr-2"></i> Save Profile
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Three.js Background
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.getElementById('canvas-container').appendChild(renderer.domElement);
        
        // Create particles
        const particlesGeometry = new THREE.BufferGeometry();
        const particlesCount = 1000;
        
        const posArray = new Float32Array(particlesCount * 3);
        for(let i = 0; i < particlesCount * 3; i++) {
            posArray[i] = (Math.random() - 0.5) * 10;
        }
        
        particlesGeometry.setAttribute('position', new THREE.BufferAttribute(posArray, 3));
        
        const particlesMaterial = new THREE.PointsMaterial({
            size: 0.05,
            color: 0xffffff,
            transparent: true,
            opacity: 0.8
        });
        
        const particlesMesh = new THREE.Points(particlesGeometry, particlesMaterial);
        scene.add(particlesMesh);
        
        camera.position.z = 5;
        
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });
        
        const animate = () => {
            requestAnimationFrame(animate);
            
            particlesMesh.rotation.x += 0.0003;
            particlesMesh.rotation.y += 0.0005;
            
            renderer.render(scene, camera);
        };
        
        animate();
        
        // View Management
        function toggleView(viewName) {
            document.querySelectorAll('.view-section').forEach(section => {
                section.classList.add('hidden');
            });
            document.getElementById(`${viewName}-view`).classList.remove('hidden');
            
            // Reset all elements with slide-in animation
            const elements = document.querySelectorAll('.slide-in');
            elements.forEach(el => {
                el.style.opacity = 0;
                el.style.animation = 'none';
                setTimeout(() => {
                    el.style.animation = '';
                }, 10);
            });
        }
        
        // Initialize Budget Charts
        document.addEventListener('DOMContentLoaded', function() {
            const budgetCtx = document.getElementById('budgetChart').getContext('2d');
            const budgetChart = new Chart(budgetCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Income', 'Expenses', 'Savings'],
                    datasets: [{
                        data: [5000, 3000, 2000],
                        backgroundColor: [
                            'rgba(92, 219, 149, 0.8)',
                            'rgba(255, 105, 97, 0.8)',
                            'rgba(73, 190, 255, 0.8)'
                        ],
                        borderColor: [
                            'rgba(92, 219, 149, 1)',
                            'rgba(255, 105, 97, 1)',
                            'rgba(73, 190, 255, 1)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                color: '#ffffff',
                                font: {
                                    family: 'Poppins'
                                }
                            }
                        }
                    }
                }
            });
            
            const trendsCtx = document.getElementById('spendingTrendsChart').getContext('2d');
            const trendsChart = new Chart(trendsCtx, {
                type: 'line',
                data: {
                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                    datasets: [{
                        label: 'Spending',
                        data: [2800, 3200, 2900, 3100, 3000, 2800],
                        borderColor: 'rgba(255, 105, 97, 1)',
                        backgroundColor: 'rgba(255, 105, 97, 0.2)',
                        tension: 0.4,
                        fill: true
                    }, {
                        label: 'Income',
                        data: [4800, 4900, 5000, 5000, 5100, 5200],
                        borderColor: 'rgba(92, 219, 149, 1)',
                        backgroundColor: 'rgba(92, 219, 149, 0.2)',
                        tension: 0.4,
                        fill: true
                    }, {
                        label: 'Savings',
                        data: [2000, 1700, 2100, 1900, 2100, 2400],
                        borderColor: 'rgba(73, 190, 255, 1)',
                        backgroundColor: 'rgba(73, 190, 255, 0.2)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        x: {
                            ticks: { color: '#ffffff' },
                            grid: { color: 'rgba(255, 255, 255, 0.1)' }
                        },
                        y: {
                            ticks: { color: '#ffffff' },
                            grid: { color: 'rgba(255, 255, 255, 0.1)' }
                        }
                    },
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: {
                                color: '#ffffff',
                                font: {
                                    family: 'Poppins'
                                }
                            }
                        }
                    }
                }
            });
        });

        // Chat Functionality
        document.getElementById('chat-input').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });

        async function sendMessage() {
            const input = document.getElementById('chat-input');
            const message = input.value.trim();
            if (!message) return;

            appendMessage(message, 'user');
            input.value = '';

            // Show loading indicator
            const chatMessages = document.getElementById('chat-messages');
            const loaderDiv = document.createElement('div');
            loaderDiv.className = 'loader';
            chatMessages.appendChild(loaderDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;

            try {
                const response = await fetch('https://r0c8kgwocscg8gsokogwwsw4.zetaverse.one/ai', {
                    method: 'POST',
                    headers: {
                        'Authorization': 'Bearer YA9zLD4r8pTSgWcxnpNaiQkGlJ22',
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        messages: [{
                            role: 'user',
                            content: [{
                                type: 'text',
                                text: `As a financial advisor, answer this question: ${message}`
                            }]
                        }]
                    })
                });

                const data = await response.json();
                loaderDiv.remove();
                appendMessage(data.message || "I understand your financial question. Let me help you with that!", 'bot');
            } catch (error) {
                loaderDiv.remove();
                appendMessage("I'm having trouble connecting to my financial database. Please try again later.", 'bot');
            }
        }

        function appendMessage(message, sender) {
            const chatMessages = document.getElementById('chat-messages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `mb-4 ${sender === 'user' ? 'text-right' : ''}`;
            
            messageDiv.innerHTML = `
                <div class="glassmorphism p-3 inline-block rounded-lg max-w-[80%] ${sender === 'user' ? 'bg-[rgba(100,149,237,0.3)]' : ''}">
                    ${sender === 'bot' ? '<i class="bi bi-robot mr-2 text-blue-300"></i>' : ''}
                    <p>${message}</p>
                </div>
            `;
            
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        // Voice Input
        let recognition;
        let isListening = false;
        
        function setupSpeechRecognition() {
            if (!('webkitSpeechRecognition' in window)) {
                alert('Speech recognition is not supported in your browser.');
                return false;
            }
            
            recognition = new webkitSpeechRecognition();
            recognition.continuous = false;
            recognition.interimResults = false;
            recognition.lang = 'en-US';
            
            recognition.onresult = function(event) {
                const input = document.getElementById('chat-input');
                input.value = event.results[0][0].transcript;
                toggleVoiceInput(); // Stop listening
            };
            
            recognition.onend = function() {
                const voiceButton = document.getElementById('voice-button');
                voiceButton.classList.remove('voice-active');
                isListening = false;
            };
            
            return true;
        }
        
        function toggleVoiceInput() {
            if (!recognition) {
                if (!setupSpeechRecognition()) return;
            }
            
            const voiceButton = document.getElementById('voice-button');
            
            if (!isListening) {
                recognition.start();
                voiceButton.classList.add('voice-active');
                isListening = true;
            } else {
                recognition.stop();
                voiceButton.classList.remove('voice-active');
                isListening = false;
            }
        }

        // Expense Tracking
        const categories = [
            { name: 'Housing', icon: 'bi-house-fill', color: 'text-blue-300' },
            { name: 'Food', icon: 'bi-cart-fill', color: 'text-yellow-300' },
            { name: 'Transportation', icon: 'bi-car-front-fill', color: 'text-green-300' },
            { name: 'Utilities', icon: 'bi-lightning-fill', color: 'text-red-300' },
            { name: 'Entertainment', icon: 'bi-film', color: 'text-purple-300' },
            { name: 'Healthcare', icon: 'bi-heart-pulse-fill', color: 'text-pink-300' },
            { name: 'Shopping', icon: 'bi-bag-fill', color: 'text-orange-300' },
            { name: 'Other', icon: 'bi-three-dots', color: 'text-gray-300' }
        ];
        
        function addExpense() {
            // Create a modal for adding expense
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 flex items-center justify-center z-50 bg-black bg-opacity-50';
            modal.innerHTML = `
                <div class="glassmorphism p-6 w-[90%] max-w-md slide-in">
                    <h3 class="text-xl font-bold mb-4">Add New Expense</h3>
                    <div class="space-y-4">
                        <div>
                            <label class="block mb-2">Amount</label>
                            <input type="number" id="expense-amount" class="chat-input w-full p-3" placeholder="$">
                        </div>
                        <div>
                            <label class="block mb-2">Category</label>
                            <div class="grid grid-cols-4 gap-2">
                                ${categories.map((cat, idx) => `
                                    <div class="category-option text-center cursor-pointer p-2 rounded-lg hover:bg-white hover:bg-opacity-20" data-category="${cat.name}" data-idx="${idx}">
                                        <i class="bi ${cat.icon} ${cat.color} text-2xl"></i>
                                        <p class="text-sm mt-1">${cat.name}</p>
                                    </div>
                                `).join('')}
                            </div>
                            <input type="hidden" id="expense-category" value="Other">
                            <input type="hidden" id="expense-category-idx" value="7">
                        </div>
                        <div>
                            <label class="block mb-2">Description (Optional)</label>
                            <input type="text" id="expense-desc" class="chat-input w-full p-3" placeholder="Description">
                        </div>
                    </div>
                    <div class="flex justify-end gap-2 mt-6">
                        <button class="glass-button px-4 py-2" onclick="this.parentNode.parentNode.parentNode.remove()">Cancel</button>
                        <button class="glass-button px-4 py-2 bg-blue-500 bg-opacity-30" onclick="saveExpense()">Save</button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Category selection
            const categoryOptions = modal.querySelectorAll('.category-option');
            categoryOptions.forEach(option => {
                option.addEventListener('click', function() {
                    categoryOptions.forEach(opt => opt.classList.remove('bg-white', 'bg-opacity-20'));
                    this.classList.add('bg-white', 'bg-opacity-20');
                    document.getElementById('expense-category').value = this.dataset.category;
                    document.getElementById('expense-category-idx').value = this.dataset.idx;
                });
            });
        }
        
        function saveExpense() {
            const amount = document.getElementById('expense-amount').value;
            const category = document.getElementById('expense-category').value;
            const categoryIdx = document.getElementById('expense-category-idx').value;
            const description = document.getElementById('expense-desc').value || category;
            
            if (!amount) {
                alert('Please enter an amount');
                return;
            }
            
            const expenseList = document.getElementById('expense-list');
            const expenseItem = document.createElement('div');
            expenseItem.className = 'glassmorphism p-3 flex justify-between slide-in';
            
            const selectedCategory = categories[categoryIdx];
            
            expenseItem.innerHTML = `
                <div class="flex items-center">
                    <i class="bi ${selectedCategory.icon} ${selectedCategory.color} mr-2"></i>
                    <span>${description}</span>
                </div>
                <span>$${parseFloat(amount).toFixed(2)}</span>
            `;
            
            expenseList.prepend(expenseItem);
            
            // Remove modal
            document.querySelector('.fixed').remove();
            
            // Save to database
            saveExpenseToDatabase(amount, category, description);
        }
        
        async function saveExpenseToDatabase(amount, category, description) {
            try {
                const response = await fetch('https://r0c8kgwocscg8gsokogwwsw4.zetaverse.one/mongodb', {
                    method: 'POST',
                    headers: {
                        'Authorization': 'Bearer YA9zLD4r8pTSgWcxnpNaiQkGlJ22',
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        appSlug: 'finbuddy-123456',
                        action: 'create',
                        collection: 'expenses',
                        data: {
                            amount: parseFloat(amount),
                            category: category,
                            description: description,
                            date: new Date().toISOString()
                        }
                    })
                });
                
                const data = await response.json();
                console.log('Expense saved:', data);
            } catch (error) {
                console.error('Error saving expense:', error);
            }
        }

        // Profile Form
        document.getElementById('profile-form').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const saveBtn = document.getElementById('save-profile-btn');
            const originalBtnText = saveBtn.innerHTML;
            saveBtn.innerHTML = '<i class="bi bi-hourglass-split animate-spin mr-2"></i> Saving...';
            saveBtn.disabled = true;
            
            const profileData = {
                income: parseFloat(document.getElementById('income').value),
                expenses: parseFloat(document.getElementById('expenses').value),
                goals: document.getElementById('goals').value,
                riskTolerance: document.getElementById('risk').value,
                debt: parseFloat(document.getElementById('debt').value),
                savings: parseFloat(document.getElementById('savings').value),
                investments: parseFloat(document.getElementById('investments').value),
                updatedAt: new Date().toISOString()
            };

            try {
                const response = await fetch('https://r0c8kgwocscg8gsokogwwsw4.zetaverse.one/mongodb', {
                    method: 'POST',
                    headers: {
                        'Authorization': 'Bearer YA9zLD4r8pTSgWcxnpNaiQkGlJ22',
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        appSlug: 'finbuddy-123456',
                        action: 'create',
                        collection: 'profiles',
                        data: profileData
                    })
                });

                const data = await response.json();
                
                if (data.success) {
                    saveBtn.innerHTML = '<i class="bi bi-check-circle mr-2"></i> Saved!';
                    setTimeout(() => {
                        saveBtn.innerHTML = originalBtnText;
                        saveBtn.disabled = false;
                    }, 2000);
                    
                    // Show success message
                    const toast = document.createElement('div');
                    toast.className = 'fixed bottom-4 right-4 glassmorphism p-4 flex items-center text-green-300 slide-in';
                    toast.innerHTML = '<i class="bi bi-check-circle-fill mr-2 text-xl"></i> Profile saved successfully!';
                    document.body.appendChild(toast);
                    setTimeout(() => toast.remove(), 3000);
                }
            } catch (error) {
                saveBtn.innerHTML = '<i class="bi bi-x-circle mr-2"></i> Error';
                setTimeout(() => {
                    saveBtn.innerHTML = originalBtnText;
                    saveBtn.disabled = false;
                }, 2000);
                
                // Show error message
                const toast = document.createElement('div');
                toast.className = 'fixed bottom-4 right-4 glassmorphism p-4 flex items-center text-red-300 slide-in';
                toast.innerHTML = '<i class="bi bi-x-circle-fill mr-2 text-xl"></i> Error saving profile';
                document.body.appendChild(toast);
                setTimeout(() => toast.remove(), 3000);
            }
        });
        
        // Initialize default view
        document.addEventListener('DOMContentLoaded', function() {
            toggleView('chat');
        });
    </script>
<script>document.body.addEventListener('wheel', e => { if (!e.ctrlKey) return; e.preventDefault(); return }, { passive: false })</script>
	</body>
</html>